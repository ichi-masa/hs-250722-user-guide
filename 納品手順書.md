# 納品手順書

## 納品物の内容

クライアント様には **`dist`フォルダのみ** を納品してください。

```
納品フォルダ/
└── dist/
    ├── en-GB/              ← 英語版（デフォルト言語）
    │   ├── index.html
    │   ├── assets/
    │   │   ├── css/
    │   │   ├── js/
    │   │   ├── img/
    │   │   ├── fonts/
    │   │   └── data/
    │   │       ├── languages.json      ← 言語設定ファイル
    │   │       └── searchdata-en-GB.json  ← 検索データ
    │   └── (その他HTMLファイル...)
    └── (追加言語がある場合は同様のフォルダ構成)
```

## クライアント様への使用説明

### 1. 基本的な使い方

`dist`フォルダの内容をそのままWebサーバーにアップロードするだけで使用できます。

- 開発環境の構築は不要
- Node.jsやGulpのインストールは不要
- HTMLファイルをそのまま編集可能

### 2. 多言語対応の仕組み

このサイトは多言語対応機能が実装されています。

#### 言語切り替えの仕組み
- サイト右上の言語切り替えボタンで言語を選択可能
- 選択した言語はブラウザに記憶され、次回訪問時も維持されます
- 言語情報は `/assets/data/languages.json` で管理されています

#### 現在対応している言語
- 英語（en-GB）：デフォルト言語
- その他追加済みの言語（`languages.json`参照）

---

## 新しい言語を追加する方法

クライアント様が新しい言語を追加したい場合の手順です。

### 前提条件

新しい言語を追加するには、以下の環境が必要です:

- **Node.js バージョン18以上**
  - [Node.js公式サイト](https://nodejs.org/)からダウンロード
  - インストール確認：ターミナルで `node -v` を実行してバージョンが表示されればOK

### 手順1：言語フォルダの作成

1. `dist`フォルダ内の既存言語フォルダ（例：`en-GB`）をコピー
2. 新しい言語コードにフォルダ名を変更（例：`de-DE`、`fr-FR`など）

```
dist/
├── en-GB/           ← 既存の英語版をコピー
└── de-DE/           ← 新しく作成したドイツ語版
```

#### 言語コード一覧（参考）

| 言語 | コード |
|------|--------|
| 日本語 | ja-JP |
| ドイツ語 | de-DE |
| フランス語 | fr-FR |
| スペイン語 | es-ES |
| イタリア語 | it-IT |
| 中国語（簡体字） | zh-CN |
| 中国語（繁体字） | zh-TW |
| 韓国語 | ko-KR |

### 手順2：HTMLファイルの翻訳

新しく作成した言語フォルダ内のHTMLファイルを翻訳してください。

- すべての `.html` ファイルを対象言語に翻訳
- 画像の `alt` 属性なども翻訳を推奨

### 手順3：言語設定ファイルの更新

`dist/[任意の言語]/assets/data/languages.json` を編集します。

**編集前の例:**
```json
{
  "languages": [
    {
      "code": "en-GB",
      "name": "English",
      "default": true
    }
  ]
}
```

**編集後の例（ドイツ語を追加）:**
```json
{
  "languages": [
    {
      "code": "en-GB",
      "name": "English",
      "default": true
    },
    {
      "code": "de-DE",
      "name": "Deutsch"
    }
  ]
}
```

**注意事項:**
- すべての言語フォルダの `languages.json` を同じ内容に更新してください
- `"default": true` は1つの言語にのみ設定（通常は英語）
- 追加した言語には `"default"` プロパティは不要

### 手順4：検索データの自動生成

新しい言語の検索機能を有効にするため、検索データを生成します。

#### 4-1. 開発用ファイルの準備

納品時に以下のファイルも一緒に提供します（クライアント様がこの作業を行う場合に必要）:

```
開発用ファイル/
├── generate-search-data.js    ← 検索データ生成スクリプト
├── package.json                ← 必要なパッケージ情報
└── package-lock.json           ← バージョン固定ファイル
```

これらのファイルを `dist`フォルダと同じ階層に配置してください:

```
プロジェクトフォルダ/
├── dist/                      ← Webサイト本体
│   ├── en-GB/
│   ├── de-DE/
│   └── ...
├── generate-search-data.js    ← 開発用ファイル
├── package.json               ← 開発用ファイル
└── package-lock.json          ← 開発用ファイル
```

#### 4-2. 必要なツールのインストール（初回のみ）

ターミナルまたはコマンドプロンプトで、プロジェクトフォルダに移動し、以下のコマンドを実行:

```bash
npm install
```

このコマンドで必要な軽量なパッケージ（cheerio）のみがインストールされます。
**Gulpや重い開発環境はインストールされません。**

#### 4-3. 検索データの生成

以下のコマンドを実行:

```bash
node generate-search-data.js
```

**実行結果（例）:**
```
[INFO] 見つかった言語: en-GB, de-DE

[INFO] en-GB: 32ファイルを処理中...
[SUCCESS] 生成完了: assets/data/searchdata-en-GB.json (32ページ)

[INFO] de-DE: 32ファイルを処理中...
[SUCCESS] 生成完了: assets/data/searchdata-de-DE.json (32ページ)

[COMPLETE] 2言語、合計64ページの検索データを生成しました。
```

成功すると、各言語フォルダの `/assets/data/` に検索用JSONファイルが自動生成されます:

```
dist/
├── en-GB/
│   └── assets/data/
│       ├── languages.json
│       └── searchdata-en-GB.json  ← 自動生成
└── de-DE/
    └── assets/data/
        ├── languages.json
        └── searchdata-de-DE.json  ← 自動生成
```

### 手順5：動作確認

1. ブラウザで `dist`フォルダ内の `index.html` を開く
2. 言語切り替えボタンが表示されることを確認
3. 新しく追加した言語を選択して正しく表示されるか確認
4. 検索機能が正しく動作するか確認

---

## トラブルシューティング

### エラー: `distディレクトリが見つかりません`

**原因:** `dist`フォルダが存在しない、または実行場所が間違っている

**解決策:**
- `dist`フォルダと開発用ファイル（`generate-search-data.js`など）が同じ階層にあることを確認
- ターミナルで正しいフォルダに移動しているか確認

### エラー: `cheerio が見つかりません`

**原因:** 必要なパッケージがインストールされていない

**解決策:**
```bash
npm install
```

### エラー: `node コマンドが見つかりません`

**原因:** Node.jsがインストールされていない

**解決策:** [Node.js公式サイト](https://nodejs.org/)からダウンロードしてインストール

### 言語が切り替わらない

**原因:** `languages.json` の設定が間違っている、または全言語フォルダで統一されていない

**解決策:**
- すべての言語フォルダの `languages.json` が同じ内容か確認
- JSON形式が正しいか確認（カンマの位置、括弧の閉じ忘れなど）

### 検索機能が動作しない

**原因:** 検索データが生成されていない、またはファイル名が間違っている

**解決策:**
- `node generate-search-data.js` を実行して検索データを生成
- 各言語フォルダの `/assets/data/` に `searchdata-[言語コード].json` が存在するか確認

---

## よくある質問（FAQ）

### Q1. 言語を追加するたびに、すべての言語の検索データを再生成する必要がありますか?

**A:** はい。`node generate-search-data.js` を実行すると、`dist`フォルダ内のすべての言語フォルダの検索データが自動的に再生成されます。これにより、すべての言語で最新のコンテンツが検索可能になります。

### Q2. HTMLを修正した場合、検索データも更新する必要がありますか?

**A:** はい。HTMLファイルの内容を変更した場合は、検索データも更新することを推奨します。`node generate-search-data.js` を実行してください。

### Q3. `languages.json` はどの言語フォルダを編集すればいいですか?

**A:** すべての言語フォルダの `languages.json` を同じ内容に更新してください。1つだけ編集すると、言語切り替え時に不整合が発生する可能性があります。

### Q4. 開発環境がない環境でも言語追加できますか?

**A:** HTMLファイルの翻訳と `languages.json` の編集は開発環境なしで可能ですが、検索データの自動生成には Node.js が必要です。検索機能を使わない場合は、Node.js なしでも言語追加は可能です。

### Q5. デフォルト言語を変更できますか?

**A:** 可能です。`languages.json` の変更したい言語に `"default": true` を設定し、他の言語から `"default"` プロパティを削除してください。

---

## サポート連絡先

不明点や問題が発生した場合は、開発元にお問い合わせください。

---

**最終更新日:** 2025年10月29日
