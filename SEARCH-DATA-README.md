# 検索データの自動生成ガイド

このドキュメントでは、HTMLファイルを翻訳した後に検索データ（JSON）を自動生成する方法を説明します。

## 概要

このプロジェクトでは、HTMLファイルから自動的に検索用のJSONファイルを生成するNode.jsスクリプトが用意されています。
HTMLを翻訳するだけで、検索データも自動的に多言語対応されます。

## 重要：Gulpは不要です

このスクリプトは**Node.jsだけで動作します**。
- Gulpのインストールは不要
- 開発環境の構築は不要
- Node.jsさえあれば使えます

## 必要な環境

- **Node.js** バージョン18以上
  - [Node.js公式サイト](https://nodejs.org/)からダウンロードしてインストールしてください
  - インストール確認：`node -v` でバージョンが表示されればOK

## 必要なファイル

納品ファイルに以下が含まれています：

```
プロジェクトフォルダ/
├── generate-search-data.js      ← 検索データ生成スクリプト
├── package.json                 ← 依存パッケージ情報
├── package-lock.json            ← バージョン固定ファイル
└── dist/
    ├── en-GB/
    │   ├── index.html
    │   └── assets/data/
    │       └── searchdata-en-GB.json  ← 自動生成される
    ├── ja-JP/
    │   └── ...
    └── ... (他の言語)
```

## 使い方

### ステップ1：初回のみ（環境セットアップ）

プロジェクトフォルダで以下のコマンドを実行してください：

```bash
npm install
```

このコマンドで必要なツール（cheerio）がインストールされます。

**注意：Gulpはインストールされません。Node.jsの軽量なパッケージのみインストールされます。**

### ステップ2：HTMLを翻訳

`dist`フォルダ内のHTMLファイルを翻訳します。

### ステップ3：検索データを生成（毎回実行）

プロジェクトフォルダで以下のコマンドを実行します：

```bash
node generate-search-data.js
```

**これだけで、すべての言語の検索データが自動生成されます。**

## 多言語対応

このスクリプトは自動的に全言語に対応します：
- `dist`フォルダ内の全ての言語フォルダを自動検出
- 各言語ごとに検索データを生成
- 新しい言語を追加した場合も自動で対応

## 生成されるファイル

各言語フォルダの `assets/data/` に検索用JSONファイルが生成されます：

```
dist/
├── en-GB/
│   └── assets/data/
│       └── searchdata-en-GB.json  ← 自動生成
├── ja-JP/
│   └── assets/data/
│       └── searchdata-ja-JP.json  ← 自動生成
├── fr-FR/
│   └── assets/data/
│       └── searchdata-fr-FR.json  ← 自動生成
└── ...（他の言語も同様）
```

## 実行結果の確認

コマンド実行後、以下のような表示が出れば成功です：

```
[INFO] 見つかった言語: en-GB, ja-JP, fr-FR, ...

[INFO] en-GB: 32ファイルを処理中...
[SUCCESS] 生成完了: assets/data/searchdata-en-GB.json (32ページ)

[INFO] ja-JP: 32ファイルを処理中...
[SUCCESS] 生成完了: assets/data/searchdata-ja-JP.json (32ページ)

[COMPLETE] 26言語、合計832ページの検索データを生成しました。
```

## 検索データの内容

生成されるJSONファイルには、各ページの以下の情報が含まれます：

- **title**: ページタイトル（`<title>`タグから抽出）
- **url**: ページのURL
- **description**: ページの説明（`<meta name="description">`から抽出）
- **content**: ページ本文（HTMLから自動抽出）

## トラブルシューティング

### エラー: `distディレクトリが見つかりません`

`dist`フォルダが存在することを確認してください。

### エラー: `cheerio が見つかりません`

以下のコマンドを実行してください：

```bash
npm install
```

### エラー: `node コマンドが見つかりません`

Node.jsがインストールされていません。
[Node.js公式サイト](https://nodejs.org/)からダウンロードしてインストールしてください。

## サポート

問題が解決しない場合は、開発元にお問い合わせください。

---

**最終更新**: 2025年
